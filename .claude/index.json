{
  "timestamp": "2025-11-05T15:02:47+08:00",
  "project_name": "onnxtools - ONNX车辆牌照识别系统",
  "project_root": "/home/tyjt/桌面/onnx_vehicle_plate_recognition",
  "summary": {
    "total_python_files": 185,
    "core_python_files": 35,
    "config_files": 3,
    "test_files": 33,
    "doc_files": 85,
    "modules": 10,
    "specs_count": 6
  },
  "scan_coverage": {
    "estimated_total_files": 185,
    "scanned_files": 185,
    "coverage_percentage": 100.0,
    "truncated": false,
    "scan_method": "混合策略（Glob + 重点文件读取）",
    "scan_duration_estimate": "约10分钟"
  },
  "ignore_rules": {
    "from_gitignore": [
      "__pycache__/",
      "*.py[cod]",
      "*.pyo",
      "*.pyd",
      "*.pdb",
      "*.egg-info/",
      "*.eggs/",
      "*.log",
      ".ipynb_checkpoints/",
      "venv/",
      "env/",
      "ENV/",
      ".venv/",
      ".env/",
      ".vscode/",
      "*.onnx",
      "*.pth",
      "*.pt",
      "*.h5",
      "*.ckpt",
      "*.pb",
      "*.tflite",
      "*.weights",
      "*.engine",
      "*.plan",
      "*.trt",
      ".DS_Store",
      "Thumbs.db",
      "data/*.mp4",
      "data/*.avi",
      "data/*.mov",
      "data/*.mkv",
      "data/*.flv",
      "data/*.webm",
      "data/*.mp3",
      "data/*.wav",
      "data/*.jpg",
      "runs/",
      "run.sh",
      "DEBUG/",
      "third_party/"
    ],
    "ignored_directories_summary": {
      "third_party": "第三方库（Ultralytics, Polygraphy, RF-DETR, TRT Engine Explorer）- 约1000+文件",
      "runs": "运行结果和评估输出目录",
      "DEBUG": "调试和开发临时文件",
      "__pycache__": "Python缓存文件",
      ".vscode": "编辑器配置",
      ".ipynb_checkpoints": "Jupyter笔记本检查点"
    }
  },
  "modules": [
    {
      "path": "onnxtools/",
      "name": "onnxtools (核心Python包)",
      "language": "python",
      "status": "active",
      "type": "python_package",
      "entry_points": [
        "onnxtools/__init__.py",
        "onnxtools/pipeline.py",
        "onnxtools.create_detector()"
      ],
      "description": "ONNX推理工具包核心模块，提供统一的模型推理接口和工具函数",
      "key_interfaces": [
        "create_detector()",
        "BaseORT",
        "YoloORT",
        "RtdetrORT",
        "RfdetrORT",
        "OcrORT",
        "ColorLayerORT",
        "DatasetEvaluator",
        "OCRDatasetEvaluator"
      ],
      "key_files": [
        "onnxtools/__init__.py",
        "onnxtools/pipeline.py"
      ],
      "submodules": ["infer_onnx", "utils"],
      "dependencies": {
        "onnxruntime-gpu": "1.22.0",
        "opencv-contrib-python": ">=4.12.0.88",
        "numpy": ">=2.2.6",
        "supervision": "0.26.1",
        "python-levenshtein": ">=0.25.0",
        "colorlog": ">=6.9.0"
      },
      "tests": [
        "tests/unit/ (62个测试)",
        "tests/integration/ (30个测试)",
        "tests/contract/ (15个测试)",
        "tests/performance/ (1个测试)"
      ],
      "test_pass_rate": "96.6% (170/176)",
      "documentation": "onnxtools/CLAUDE.md"
    },
    {
      "path": "onnxtools/infer_onnx/",
      "name": "infer_onnx (推理引擎子模块)",
      "language": "python",
      "status": "active",
      "type": "python_submodule",
      "entry_points": [
        "onnxtools/infer_onnx/__init__.py",
        "onnxtools/infer_onnx/onnx_base.py::BaseORT"
      ],
      "description": "ONNX推理引擎，支持YOLO/RT-DETR/RF-DETR等多种架构，OCR识别和颜色分类",
      "key_interfaces": [
        "BaseORT (抽象基类)",
        "YoloORT",
        "RtdetrORT",
        "RfdetrORT",
        "OcrORT",
        "ColorLayerORT",
        "DatasetEvaluator",
        "OCRDatasetEvaluator",
        "SampleEvaluation"
      ],
      "key_files": [
        "onnx_base.py",
        "onnx_yolo.py",
        "onnx_rtdetr.py",
        "onnx_rfdetr.py",
        "onnx_ocr.py",
        "eval_coco.py",
        "eval_ocr.py",
        "infer_utils.py",
        "engine_dataloader.py"
      ],
      "tests": [
        "tests/unit/test_ocr_onnx_refactored.py (27个)",
        "tests/contract/test_ocr_onnx_refactored_contract.py",
        "tests/contract/test_ocr_evaluator_contract.py (11个)",
        "tests/integration/test_ocr_evaluation_integration.py (8个)"
      ],
      "documentation": "onnxtools/infer_onnx/CLAUDE.md"
    },
    {
      "path": "onnxtools/utils/",
      "name": "utils (工具函数子模块)",
      "language": "python",
      "status": "active",
      "type": "python_submodule",
      "entry_points": [
        "onnxtools/utils/__init__.py",
        "onnxtools/utils/pipeline.py"
      ],
      "description": "工具函数库，包含图像处理、可视化、Supervision集成、OCR指标计算",
      "key_interfaces": [
        "preprocess_image()",
        "draw_detections_supervision()",
        "convert_to_supervision_detections()",
        "AnnotatorFactory",
        "AnnotatorPipeline",
        "load_visualization_preset()",
        "OCR指标计算函数"
      ],
      "key_files": [
        "pipeline.py",
        "image_processing.py",
        "drawing.py",
        "supervision_converter.py",
        "supervision_config.py",
        "supervision_labels.py",
        "annotator_factory.py",
        "visualization_preset.py",
        "ocr_metrics.py",
        "detection_metrics.py",
        "nms.py",
        "font_utils.py"
      ],
      "annotator_types": 13,
      "preset_scenes": 5,
      "tests": [
        "tests/unit/test_ocr_metrics.py (23个)",
        "tests/unit/test_load_label_file.py (12个)",
        "tests/integration/test_supervision_only.py",
        "tests/integration/test_annotator_*.py (多个)",
        "tests/performance/test_annotator_benchmark.py"
      ],
      "documentation": "onnxtools/utils/CLAUDE.md"
    },
    {
      "path": "tools/",
      "name": "tools (调试和优化工具)",
      "language": "python",
      "status": "active",
      "type": "script_collection",
      "entry_points": [
        "tools/eval.py",
        "tools/build_engine.py",
        "tools/eval_ocr.py",
        "tools/compare_onnx_engine.py"
      ],
      "description": "调试和优化工具，包括模型评估、TensorRT构建、性能分析、OCR评估",
      "key_files": [
        "eval.py",
        "build_engine.py",
        "compare_onnx_engine.py",
        "eval_ocr.py",
        "draw_engine.py",
        "layer_statistics.py",
        "tensor_selector.py",
        "network_postprocess.py",
        "debug/ (调试脚本集合)"
      ],
      "dependencies": {
        "tensorrt": "8.6.1.post1 (可选)",
        "polygraphy": ">=0.49.26",
        "matplotlib": ">=3.10.6"
      },
      "documentation": "tools/CLAUDE.md"
    },
    {
      "path": "configs/",
      "name": "configs (配置文件)",
      "language": "yaml",
      "status": "active",
      "type": "configuration",
      "description": "配置文件集合，包含检测配置、OCR字典、可视化预设",
      "key_files": [
        "det_config.yaml (检测类别和颜色配置)",
        "plate.yaml (OCR字典和颜色/层级映射)",
        "visualization_presets.yaml (Supervision可视化预设)"
      ],
      "documentation": null
    },
    {
      "path": "models/",
      "name": "models (模型资源)",
      "language": "binary",
      "status": "active",
      "type": "model_storage",
      "description": "ONNX模型文件和TensorRT引擎存储目录（.gitignore忽略）",
      "key_files": [
        "rtdetr-2024080100.onnx",
        "rfdetr-20250811.onnx",
        "yolo11n.onnx",
        "ocr.onnx",
        "color_layer.onnx",
        "*.engine (TensorRT引擎)"
      ],
      "documentation": "models/CLAUDE.md"
    },
    {
      "path": "tests/",
      "name": "tests (测试体系)",
      "language": "python",
      "status": "active",
      "type": "test_suite",
      "entry_points": [
        "tests/conftest.py"
      ],
      "description": "测试体系，包括单元测试、集成测试、合约测试、性能测试",
      "key_directories": [
        "tests/unit/ (单元测试)",
        "tests/integration/ (集成测试)",
        "tests/contract/ (合约测试)",
        "tests/performance/ (性能测试)"
      ],
      "test_counts": {
        "unit": 62,
        "integration": 30,
        "contract": 15,
        "performance": 1,
        "total": 108
      },
      "test_pass_rate": "96.6% (170/176)",
      "dependencies": {
        "pytest": ">=7.0.0",
        "pytest-cov": ">=7.0.0",
        "pytest-benchmark": "latest"
      },
      "documentation": "tests/CLAUDE.md"
    },
    {
      "path": "specs/",
      "name": "specs (功能规范)",
      "language": "markdown",
      "status": "active",
      "type": "specification",
      "description": "功能规范文档，采用规范驱动开发(Spec-Driven Development)流程",
      "specs_count": 6,
      "specs": [
        {
          "id": "001-supervision-plate-box",
          "title": "Supervision库可视化集成",
          "status": "In Progress",
          "phase": "Phase 2"
        },
        {
          "id": "002-delete-old-draw",
          "title": "旧版绘制代码重构",
          "status": "Completed"
        },
        {
          "id": "003-add-more-annotators",
          "title": "Annotators扩展集成",
          "status": "Completed"
        },
        {
          "id": "004-refactor-colorlayeronnx-ocronnx",
          "title": "ColorLayerONNX和OCRONNX重构",
          "status": "Completed"
        },
        {
          "id": "005-baseonnx-postprocess-call",
          "title": "BaseOnnx抽象方法强制实现",
          "status": "Completed"
        },
        {
          "id": "006-make-ocr-metrics",
          "title": "OCR指标评估功能",
          "status": "Completed (Phase 4/7)"
        }
      ],
      "documentation": "specs/CLAUDE.md"
    },
    {
      "path": "openspec/",
      "name": "openspec (规范管理系统)",
      "language": "markdown",
      "status": "active",
      "type": "specification_system",
      "description": "OpenSpec规范管理系统，支持变更提案和规范归档",
      "key_files": [
        "openspec/AGENTS.md (AI助手指南)",
        "openspec/project.md (项目约定)"
      ],
      "documentation": null
    },
    {
      "path": "docs/",
      "name": "docs (项目文档)",
      "language": "markdown",
      "status": "active",
      "type": "documentation",
      "description": "项目文档，包括使用指南、Polygraphy文档、API文档",
      "key_files": [
        "docs/evaluation_guide.md (评估指南)",
        "docs/annotator_usage.md (Annotator使用指南)",
        "docs/polygraphy使用指南/ (Polygraphy完整文档)"
      ],
      "documentation": "docs/CLAUDE.md"
    }
  ],
  "coverage": {
    "module_coverage": {
      "onnxtools": "完整扫描，已生成CLAUDE.md",
      "onnxtools/infer_onnx": "完整扫描，已更新CLAUDE.md",
      "onnxtools/utils": "完整扫描，已更新CLAUDE.md",
      "tools": "完整扫描，文档已存在",
      "configs": "完整扫描，待生成CLAUDE.md",
      "models": "完整扫描，文档已存在",
      "tests": "完整扫描，文档已存在",
      "specs": "完整扫描，文档已存在",
      "openspec": "完整扫描，待生成CLAUDE.md",
      "docs": "完整扫描，文档已存在",
      "third_party": "忽略（.gitignore）"
    },
    "documentation_coverage": {
      "root_claude_md": "需要更新",
      "module_claude_md": "80% (8/10)",
      "api_documentation": "完整",
      "usage_examples": "完整"
    }
  },
  "gaps": {
    "missing_interfaces": [],
    "missing_tests": [
      "BaseORT基类功能测试",
      "图像预处理函数完整测试",
      "可视化绘制功能完整测试"
    ],
    "missing_documentation": [
      "configs/CLAUDE.md",
      "openspec/CLAUDE.md"
    ]
  },
  "statistics": {
    "total_python_files": 185,
    "core_python_files": 35,
    "total_onnx_models": 10,
    "total_yaml_configs": 3,
    "total_markdown_docs": 85,
    "total_test_files": 33,
    "total_spec_files": 6,
    "lines_of_code_estimate": "约8000行（不含third_party）"
  },
  "next_steps": [
    "补充configs/和openspec/的模块级CLAUDE.md文档",
    "添加BaseORT基类的单元测试",
    "完善图像预处理和可视化的测试覆盖",
    "完成specs/001-supervision-plate-box规范实施（Phase 2）",
    "考虑为mcp_vehicle_detection/子项目创建独立文档"
  ],
  "metadata": {
    "initialized_by": "Initialization Architect (Adaptive Version)",
    "initialization_date": "2025-11-05T15:02:47+08:00",
    "last_updated": "2025-11-05T15:02:47+08:00",
    "version": "2.0",
    "notes": "完整初始化，包含面包屑导航和Mermaid结构图"
  }
}
